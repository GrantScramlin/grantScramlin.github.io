<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Grant Scramlin - Programming Tutor</title>
  <style>
    :root {
      --primary-color: #007acc;
      --secondary-color: #f0f4f8;
      --accent-color: #005f99;
      --text-color: #333;
    }

    * {
      box-sizing: border-box;
      scroll-behavior: smooth;
    }

    body {
      margin: 0;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background-color: var(--secondary-color);
      color: var(--text-color);
    }

    header {
      background-color: var(--primary-color);
      color: white;
      padding: 2rem;
      text-align: center;
    }

    .navbar {
      background-color: white;
      padding: 1rem;
      position: sticky;
      top: 0;
      display: flex;
      justify-content: center;
      gap: 2rem;
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
      z-index: 1000;
      transition: all 0.3s ease;
    }

    .navbar a {
      text-decoration: none;
      color: var(--primary-color);
      font-weight: bold;
    }

    .container {
      max-width: 1000px;
      margin: 2rem auto;
      padding: 0 1rem;
    }

    section {
      margin-bottom: 3rem;
      background: white;
      padding: 2rem;
      border-radius: 12px;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.05);
    }

    h2 {
      color: var(--primary-color);
      margin-bottom: 1rem;
    }

    ul {
      padding-left: 1.2rem;
    }

    .booking-form input,
    .booking-form textarea {
      width: 100%;
      padding: 0.75rem;
      margin-bottom: 1rem;
      border: 1px solid #ccc;
      border-radius: 6px;
      font-size: 1rem;
    }

    .booking-form button {
      background-color: var(--primary-color);
      color: white;
      border: none;
      padding: 0.75rem 1.5rem;
      border-radius: 6px;
      font-size: 1rem;
      cursor: pointer;
      transition: background-color 0.3s ease;
    }

    .booking-form button:hover {
      background-color: var(--accent-color);
    }

    .project-gallery {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 1rem;
    }

    .project-gallery img {
      width: 100%;
      height: auto;
      border-radius: 10px;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    }


    select {
      width: 100%;
      padding: 0.5rem;
      border: 1px solid #ccc;
      margin-bottom: 1rem;
      border-radius: 8px;
      font-size: 1rem;
      background-color: #fff;
      appearance: none;
      background-image: url('data:image/svg+xml;charset=US-ASCII,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="%23666"><path d="M4 6l4 4 4-4"/></svg>');
      background-repeat: no-repeat;
      background-position: right 0.75rem center;
      background-size: 1rem;
    }

    select option:disabled {
      color: #aaa;
      background: #f8f8f8;
    }

  </style>

  <!-- Flatpickr CSS -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
  <!-- Flatpickr JS -->
  <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
</head>
<body>
  <header>
    <h1>Grant Scramlin</h1>
    <p>One-on-One Programming Tutor for Middle & High School Students</p>
  </header>

  <nav class="navbar">
    <a href="#about">About</a>
    <a href="#subjects">Subjects</a>
    <a href="#rates">Rates</a>
    <a href="#projects">Projects</a>
    <a href="#book">Book</a>
    <a href="#contact">Contact</a>
  </nav>

  <div class="container">
    <section id="about">
      <h2>About Me</h2>
      <p>Hi! I'm Grant Scramlin, a valedictorian graduate and current Robotics and Mechanical Engineering student at the University of Michigan in Ann Arbor. I'm a FIRST Robotics alumni and mentor, and I've published three verified games on the Google Play Store. I specialize in helping students understand real-world programming through hands-on projects.</p>
    </section>

    <section id="subjects">
      <h2>Subjects I Tutor</h2>
      <ul>
        <li>Python</li>
        <li>Unity (Game Development)</li>
        <li>C++</li>
        <li>JavaScript</li>
        <li>Arduino / ESP32 Robotics</li>
      </ul>
    </section>

    <section id="rates">
      <h2>Rates & Sessions</h2>
      <ul>
        <li>First 30-minute intro lesson: <strong>Free</strong></li>
        <li>30-minute lessons: <strong>$25</strong></li>
        <li>1-hour lessons: <strong>$40</strong></li>
      </ul>
    </section>

    <section id="projects">
      <h2>Project Gallery</h2>
      <div class="project-gallery">
        <!-- Replace the src values with your own project image URLs -->
        <img src="project1.jpg" alt="Project 1 Screenshot">
        <img src="project2.jpg" alt="Project 2 Screenshot">
        <img src="project3.jpg" alt="Project 3 Screenshot">
      </div>
    </section>

    <section id="book">
      <h2>Book a Session</h2>
      <form class="booking-form" id="booking-form">
        <input type="text" id="name" name="student_name" placeholder="Student Name" required />
        <input type="text" id="name" name="parent_name" placeholder="Parent/Guardian Name" required />
        <input type="email" id="email" name="parent_email" placeholder="Parent/Guardian Email" required />
        <input type="email" id="email" name="student_email" placeholder="Student Email (optional)"  />
        <select id="subject" name="subject" required>
          <option value="" disabled selected>Which topics do you want to learn?</option>
          <option value="general">Unsure/General Programming</option>
          <option value="python">Python</option>
          <option value="unity">Unity</option>
          <option value="cpp">C++</option>
          <option value="javascript">JavaScript</option>
          <option value="arduino">Arduino / ESP32</option>
        </select>
        <div style="display: flex; gap: 1rem; align-items: center;">
          <!-- Date Picker -->
          <input id="date" type="text" name="date" placeholder="Select a date (Mon/Wed/Fri)">

          <!-- Time Dropdown -->
          <select id="time" name="time" required>
            <option value="" disabled selected>Select a time</option>
            <option value="16:30">4:30 PM</option>
            <option value="17:00">5:00 PM</option>
            <option value="17:30">5:30 PM</option>
            <option value="18:00">6:00 PM</option>
            <!-- Add more time slots as needed -->
            </select>
        </div>
        <textarea id="notes" rows="4" name="notes" placeholder="Additional Notes (optional)"></textarea>
        <button type="submit">Request Session</button>
      </form>
      <p id="confirmation" style="color: green; display: none;">Thank you! I'll be in touch shortly to confirm your session.</p>
    </section>

    <section id="contact">
      <h2>Contact</h2>
      <p>Email: <a href="mailto:grantscramlin@gmail.com">grantscramlin@gmail.com</a></p>
    </section>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', function () {
      const form = document.getElementById('booking-form'); // Replace with your form's ID
      const submitBtn = form.querySelector('button[type="submit"]');

      form.addEventListener('submit', function (e) {
        submitBtn.disabled = true;
        submitBtn.textContent = "Submitting...";

        // Optional: Re-enable after a few seconds (in case Google Script is slow)
        setTimeout(() => {
          submitBtn.disabled = false;
          submitBtn.textContent = "Submit";
        }, 5000); // Adjust as needed
      });
    });
</script>

  <script>
    const timeSlots = ["16:30", "17:00", "17:30", "18:00"];

    async function initDatePicker() {
      const res = await fetch("https://script.google.com/macros/s/AKfycbxfGi6-Chdy1A9X5qyBMwqvyMg6ev1Jtor-dG1W7nuZsmtGZ6N8nZ9qKg7NtA-biVAShg/exec");
      const bookings = await res.json();
    
      const slotCountByDate = {};
      bookings.forEach(({ date, time }) => {
        const d = new Date(date).toISOString().split('T')[0]; // YYYY-MM-DD
        if (!slotCountByDate[d]) slotCountByDate[d] = new Set();
        slotCountByDate[d].add(time);
      });
    
      const fullyBookedDates = Object.entries(slotCountByDate)
        .filter(([_, times]) => times.size >= timeSlots.length)
        .map(([date]) => date);
    
      flatpickr("#date", {
        dateFormat: "Y-m-d",
        minDate: "today",
        maxDate: new Date().fp_incr(30), // 30 days out
        disable: [
          function (date) {
            const day = date.getDay();
            const iso = date.toISOString().split('T')[0];
            const isValidDay = day === 1 || day === 3 || day === 5; // Mon/Wed/Fri
            return !isValidDay || fullyBookedDates.includes(iso);
          }
        ]
      });
    
      // Store for time filtering
      window.bookedSlots = bookings;
    }

    initDatePicker();
  </script>

  <script>
    
    const dateInput = document.getElementById("date");
    const timeSelect = document.getElementById("time");
    let bookedSlots = [];

    // Fetch booked slots from Google Sheets via Apps Script GET endpoint
    fetch("https://script.google.com/macros/s/AKfycbxfGi6-Chdy1A9X5qyBMwqvyMg6ev1Jtor-dG1W7nuZsmtGZ6N8nZ9qKg7NtA-biVAShg/exec")
      .then(res => res.json())
      .then(data => {
        bookedSlots = data;
      });

    console.log("Booked Slots:", bookedSlots); // ⬅️ Prints the full array

    // When user selects a date, filter available time slots
    dateInput.addEventListener("change", () => {
      const selectedDate = dateInput.value;
      const takenTimes = bookedSlots
        .filter(slot => slot.date === selectedDate)
        .map(slot => slot.time);

      // Enable all options, then disable those that are taken
      [...timeSelect.options].forEach(option => {
        if (!option.value) return; // Skip placeholder
        option.disabled = takenTimes.includes(option.value);
      });
    });
  </script>

  <script>
    document.getElementById('booking-form').addEventListener('submit', async function (e) {
      e.preventDefault();

      const form = e.target;
      const formData = new FormData(form);

      const response = await fetch("https://script.google.com/macros/s/AKfycbxfGi6-Chdy1A9X5qyBMwqvyMg6ev1Jtor-dG1W7nuZsmtGZ6N8nZ9qKg7NtA-biVAShg/exec", {
        method: "POST",
        body: formData
      });

      if(response.ok) {
        form.reset();
        document.getElementById('confirmation').style.display = 'block';
      } else {
        alert("Something went wrong. Please try again later.");
      }
    });
  </script>
</body>
</html>